'use strict';

var expect = require("chai").expect;
var mongoose = require('../index').dbManager;

describe('Schema Strategy', function () {
	var SchemaStrategy = require('../proxy.schema.js');
	var dbSchema = new mongoose.Schema({ title: String, age: Number });

	it('can register an existing dbSchema', function () {
		var pSchema = SchemaStrategy.register('User', dbSchema);
		expect(pSchema).to.have.property('dbSchema');
		expect(SchemaStrategy).to.have.deep.property('_schemas.User');
		expect(pSchema.dbSchema instanceof mongoose.Schema).to.be.true;
	});

	it('creates a new dbSchema as part of a new pSchema', function () {
		var pSchema = new SchemaStrategy('Book', { title: String });
		expect(pSchema).to.have.property('dbSchema');
		expect(pSchema.dbSchema instanceof mongoose.Schema).to.be.true;
	});

	it('can create a pModel and dbModel from a Schema', function () {
		var House = SchemaStrategy.makeModel('House', { address: String });
		var myHouse = new House({ address: "123 Cherry Lane" });
		// expect(pSchema).to.have.property('dbSchema')
		// expect(pSchema.dbSchema instanceof mongoose.Schema).to.be.true
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3N0cmF0ZWdpZXMvbW9uZ29vc2Utc3RyYXRlZ3kvc3BlYy9zY2hlbWEuc3RyYXRlZ3kuc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQU0sU0FBUyxRQUFRLE1BQVIsRUFBZ0IsTUFBL0I7QUFDQSxJQUFNLFdBQVcsUUFBUSxVQUFSLEVBQW9CLFNBQXJDOztBQUVBLFNBQVMsaUJBQVQsRUFBNEIsWUFBVztBQUN0QyxLQUFNLGlCQUFpQixRQUFRLG9CQUFSLENBQXZCO0FBQ0EsS0FBTSxXQUFXLElBQUksU0FBUyxNQUFiLENBQW9CLEVBQUMsT0FBTyxNQUFSLEVBQWdCLEtBQUssTUFBckIsRUFBcEIsQ0FBakI7O0FBRUEsSUFBRyxtQ0FBSCxFQUF3QyxZQUFXO0FBQ2xELE1BQU0sVUFBVSxlQUFlLFFBQWYsQ0FBd0IsTUFBeEIsRUFBZ0MsUUFBaEMsQ0FBaEI7QUFDQSxTQUFPLE9BQVAsRUFBZ0IsRUFBaEIsQ0FBbUIsSUFBbkIsQ0FBd0IsUUFBeEIsQ0FBaUMsVUFBakM7QUFDQSxTQUFPLGNBQVAsRUFBdUIsRUFBdkIsQ0FBMEIsSUFBMUIsQ0FBK0IsSUFBL0IsQ0FBb0MsUUFBcEMsQ0FBNkMsZUFBN0M7QUFDQSxTQUFPLFFBQVEsUUFBUixZQUE0QixTQUFTLE1BQTVDLEVBQW9ELEVBQXBELENBQXVELEVBQXZELENBQTBELElBQTFEO0FBQ0MsRUFMRjs7QUFPQSxJQUFHLGlEQUFILEVBQXNELFlBQVc7QUFDaEUsTUFBTSxVQUFVLElBQUksY0FBSixDQUFtQixNQUFuQixFQUEyQixFQUFDLE9BQU8sTUFBUixFQUEzQixDQUFoQjtBQUNBLFNBQU8sT0FBUCxFQUFnQixFQUFoQixDQUFtQixJQUFuQixDQUF3QixRQUF4QixDQUFpQyxVQUFqQztBQUNBLFNBQU8sUUFBUSxRQUFSLFlBQTRCLFNBQVMsTUFBNUMsRUFBb0QsRUFBcEQsQ0FBdUQsRUFBdkQsQ0FBMEQsSUFBMUQ7QUFDQyxFQUpGOztBQU1BLElBQUcsK0NBQUgsRUFBb0QsWUFBVztBQUM5RCxNQUFNLFFBQVEsZUFBZSxTQUFmLENBQXlCLE9BQXpCLEVBQWtDLEVBQUMsU0FBUyxNQUFWLEVBQWxDLENBQWQ7QUFDQSxNQUFNLFVBQVUsSUFBSSxLQUFKLENBQVUsRUFBQyxTQUFTLGlCQUFWLEVBQVYsQ0FBaEI7QUFDQTtBQUNBO0FBQ0MsRUFMRjtBQVdBLENBNUJEIiwiZmlsZSI6InNjaGVtYS5zdHJhdGVneS5zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwZWN0ID0gcmVxdWlyZShcImNoYWlcIikuZXhwZWN0O1xuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9pbmRleCcpLmRiTWFuYWdlcjtcblxuZGVzY3JpYmUoJ1NjaGVtYSBTdHJhdGVneScsIGZ1bmN0aW9uKCkge1xuXHRjb25zdCBTY2hlbWFTdHJhdGVneSA9IHJlcXVpcmUoJy4uL3Byb3h5LnNjaGVtYS5qcycpO1xuXHRjb25zdCBkYlNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe3RpdGxlOiBTdHJpbmcsIGFnZTogTnVtYmVyfSk7XG5cdFxuXHRpdCgnY2FuIHJlZ2lzdGVyIGFuIGV4aXN0aW5nIGRiU2NoZW1hJywgZnVuY3Rpb24oKSB7XHRcdFx0XHRcblx0XHRjb25zdCBwU2NoZW1hID0gU2NoZW1hU3RyYXRlZ3kucmVnaXN0ZXIoJ1VzZXInLCBkYlNjaGVtYSk7XHRcdFxuXHRcdGV4cGVjdChwU2NoZW1hKS50by5oYXZlLnByb3BlcnR5KCdkYlNjaGVtYScpXG5cdFx0ZXhwZWN0KFNjaGVtYVN0cmF0ZWd5KS50by5oYXZlLmRlZXAucHJvcGVydHkoJ19zY2hlbWFzLlVzZXInKVxuXHRcdGV4cGVjdChwU2NoZW1hLmRiU2NoZW1hIGluc3RhbmNlb2YgbW9uZ29vc2UuU2NoZW1hKS50by5iZS50cnVlXG4gIH0pO1xuXG5cdGl0KCdjcmVhdGVzIGEgbmV3IGRiU2NoZW1hIGFzIHBhcnQgb2YgYSBuZXcgcFNjaGVtYScsIGZ1bmN0aW9uKCkge1xuXHRcdGNvbnN0IHBTY2hlbWEgPSBuZXcgU2NoZW1hU3RyYXRlZ3koJ0Jvb2snLCB7dGl0bGU6IFN0cmluZ30pO1xuXHRcdGV4cGVjdChwU2NoZW1hKS50by5oYXZlLnByb3BlcnR5KCdkYlNjaGVtYScpXG5cdFx0ZXhwZWN0KHBTY2hlbWEuZGJTY2hlbWEgaW5zdGFuY2VvZiBtb25nb29zZS5TY2hlbWEpLnRvLmJlLnRydWVcbiAgfSk7XG5cblx0aXQoJ2NhbiBjcmVhdGUgYSBwTW9kZWwgYW5kIGRiTW9kZWwgZnJvbSBhIFNjaGVtYScsIGZ1bmN0aW9uKCkge1xuXHRcdGNvbnN0IEhvdXNlID0gU2NoZW1hU3RyYXRlZ3kubWFrZU1vZGVsKCdIb3VzZScsIHthZGRyZXNzOiBTdHJpbmd9KTtcblx0XHRjb25zdCBteUhvdXNlID0gbmV3IEhvdXNlKHthZGRyZXNzOiBcIjEyMyBDaGVycnkgTGFuZVwifSk7XG5cdFx0Ly8gZXhwZWN0KHBTY2hlbWEpLnRvLmhhdmUucHJvcGVydHkoJ2RiU2NoZW1hJylcblx0XHQvLyBleHBlY3QocFNjaGVtYS5kYlNjaGVtYSBpbnN0YW5jZW9mIG1vbmdvb3NlLlNjaGVtYSkudG8uYmUudHJ1ZVxuICB9KTtcblxuXG5cblxuXG59KTsiXX0=